<!DOCTYPE html>

<html>
<head>
<title>{{.result.formTemplate.Description}}</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="/app/combo?yui.3.12.0/cssreset/cssreset-min.css&yui.3.12.0/cssfonts/cssfonts-min.css&yui.3.12.0/cssbase/cssbase-min.css&{{.flash.dateFlag}}" />
<link rel="stylesheet" type="text/css" href="/app/combo?yui.3.12.0/cssgrids/cssgrids-min.css&yui.3.12.0/widget-base/assets/skins/sam/widget-base.css&yui.3.12.0/datatable-base/assets/skins/sam/datatable-base.css&yui.3.12.0/widget-stack/assets/skins/sam/widget-stack.css&yui.3.12.0/overlay/assets/skins/sam/overlay.css&yui.3.12.0/calendar-base/assets/skins/sam/calendar-base.css&yui.3.12.0/calendarnavigator/assets/skins/sam/calendarnavigator.css&yui.3.12.0/calendar/assets/skins/sam/calendar.css&yui.3.12.0/datatable-message/assets/skins/sam/datatable-message.css&yui.3.12.0/datatable-sort/assets/skins/sam/datatable-sort.css&yui.3.12.0/cssbutton/cssbutton-min.css&yui.3.12.0/tabview/assets/skins/sam/tabview.css&yui.3.12.0/widget-modality/assets/skins/sam/widget-modality.css&yui.3.12.0/panel/assets/skins/sam/panel.css&gallery-2013.09.18-18-49/build/gallery-paginator-view/assets/skins/sam/gallery-paginator-view.css&gallery-2013.09.18-18-49/build/gallery-layout/assets/skins/sam/gallery-layout.css&gallery-2013.09.18-18-49/build/gallery-quickedit/assets/skins/sam/gallery-quickedit.css&gallery-2013.09.18-18-49/build/gallery-paginator/assets/skins/sam/gallery-paginator.css&{{.flash.dateFlag}}" />
<link rel="stylesheet" type="text/css" href="/public/css/global.css?{{.flash.dateFlag}}" />

<script type="text/javascript">
	YUI_config = {
		debug : true,
		combine : true,
		comboBase : '/app/combo?',
		root : 'yui.3.12.0/',
		gallery: 'gallery-2013.09.18-18-49'
	};
	// 系统参数
	var sysParam = {{.result.sysParamJson}};
	/* var sysParam = {
		localCurrency: {
			prefix: "￥",
			decimalPlaces: 3,// 金额小数位数
			unitPriceDecimalPlaces: 4// 单价小数位数
		},
		unitCostDecimalPlaces: 5,// 单位成本小数位数
		percentDecimalPlaces: 1,// 百分比小数位数
		thousandsSeparator: ","
	}; */
</script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/yui/yui-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/comboview?js/moduleConfig.js&js/common.js&js/dataTableExtend.js&js/dataTableDataSourceExtend.js&js/columnManager.js&js/columnDataSourceManager.js&js/ds_formtoolbar.js&js/modelService.js&js/modelTemplateFactory.js&js/ds_formFieldFactory.js&js/formTemplateFactory.js&js/defaultAction.js&js/relationManager.js&js/listTemplateService.js&js/templateService.js&js/columnSequenceService.js&js/formManager.js&{{.result.formTemplate.Scripts}}&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/FormJS?{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/comboview?js/form/p-form-quickedit.js&js/financeModule.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/oop/oop-min.js&yui.3.12.0/event-custom-base/event-custom-base-min.js&yui.3.12.0/event-custom-complex/event-custom-complex-min.js&yui.3.12.0/intl/intl-min.js&yui.3.12.0/dom-core/dom-core-min.js&yui.3.12.0/dom-base/dom-base-min.js&yui.3.12.0/selector-native/selector-native-min.js&yui.3.12.0/selector/selector-min.js&yui.3.12.0/node-core/node-core-min.js&yui.3.12.0/node-base/node-base-min.js&yui.3.12.0/event-base/event-base-min.js&yui.3.12.0/event-delegate/event-delegate-min.js&yui.3.12.0/node-event-delegate/node-event-delegate-min.js&yui.3.12.0/pluginhost-base/pluginhost-base-min.js&yui.3.12.0/pluginhost-config/pluginhost-config-min.js&yui.3.12.0/node-pluginhost/node-pluginhost-min.js&yui.3.12.0/color-base/color-base-min.js&yui.3.12.0/dom-style/dom-style-min.js&yui.3.12.0/dom-screen/dom-screen-min.js&yui.3.12.0/node-screen/node-screen-min.js&yui.3.12.0/node-style/node-style-min.js&yui.3.12.0/attribute-core/attribute-core-min.js&yui.3.12.0/attribute-observable/attribute-observable-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/attribute-extras/attribute-extras-min.js&yui.3.12.0/attribute-base/attribute-base-min.js&yui.3.12.0/attribute-complex/attribute-complex-min.js&yui.3.12.0/base-core/base-core-min.js&yui.3.12.0/base-observable/base-observable-min.js&yui.3.12.0/base-base/base-base-min.js&yui.3.12.0/base-pluginhost/base-pluginhost-min.js&yui.3.12.0/classnamemanager/classnamemanager-min.js&yui.3.12.0/event-synthetic/event-synthetic-min.js&yui.3.12.0/event-focus/event-focus-min.js&yui.3.12.0/widget-base/widget-base-min.js&yui.3.12.0/widget-htmlparser/widget-htmlparser-min.js&yui.3.12.0/querystring-stringify-simple/querystring-stringify-simple-min.js&yui.3.12.0/io-base/io-base-min.js&yui.3.12.0/io-form/io-form-min.js&yui.3.12.0/arraylist/arraylist-min.js&yui.3.12.0/base-build/base-build-min.js&yui.3.12.0/widget-skin/widget-skin-min.js&yui.3.12.0/widget-uievents/widget-uievents-min.js&yui.3.12.0/widget-parent/widget-parent-min.js&yui.3.12.0/widget-child/widget-child-min.js&yui.3.12.0/substitute/substitute-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/io-upload-iframe/io-upload-iframe-min.js&yui.3.12.0/array-extras/array-extras-min.js&yui.3.12.0/arraylist-add/arraylist-add-min.js&yui.3.12.0/arraylist-filter/arraylist-filter-min.js&yui.3.12.0/array-invoke/array-invoke-min.js&yui.3.12.0/widget-stdmod/widget-stdmod-min.js&yui.3.12.0/widget-position/widget-position-min.js&yui.3.12.0/widget-position-align/widget-position-align-min.js&yui.3.12.0/widget-stack/widget-stack-min.js&yui.3.12.0/widget-position-constrain/widget-position-constrain-min.js&yui.3.12.0/overlay/overlay-min.js&yui.3.12.0/datatype-date-parse/datatype-date-parse-min.js&yui.3.12.0/datatype-date-format/lang/datatype-date-format_zh-Hant-TW.js&yui.3.12.0/datatype-date-format/datatype-date-format-min.js&yui.3.12.0/datatype-date-math/datatype-date-math-min.js&yui.3.12.0/calendar-base/lang/calendar-base_zh-HANT-TW.js&yui.3.12.0/calendar-base/calendar-base-min.js&yui.3.12.0/plugin/plugin-min.js&yui.3.12.0/calendarnavigator/calendarnavigator-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/calendar/calendar-min.js&yui.3.12.0/escape/escape-min.js&yui.3.12.0/json-parse/json-parse-min.js&yui.3.12.0/model/model-min.js&yui.3.12.0/model-list/model-list-min.js&yui.3.12.0/datatable-core/datatable-core-min.js&yui.3.12.0/view/view-min.js&yui.3.12.0/datatable-head/datatable-head-min.js&yui.3.12.0/datatable-body/datatable-body-min.js&yui.3.12.0/datatable-table/datatable-table-min.js&yui.3.12.0/datatable-base/datatable-base-min.js&yui.3.12.0/event-mousewheel/event-mousewheel-min.js&yui.3.12.0/event-mouseenter/event-mouseenter-min.js&yui.3.12.0/event-key/event-key-min.js&yui.3.12.0/event-resize/event-resize-min.js&yui.3.12.0/event-hover/event-hover-min.js&yui.3.12.0/event-outside/event-outside-min.js&yui.3.12.0/event-touch/event-touch-min.js&yui.3.12.0/event-move/event-move-min.js&yui.3.12.0/event-flick/event-flick-min.js&yui.3.12.0/event-valuechange/event-valuechange-min.js&yui.3.12.0/event-tap/event-tap-min.js&yui.3.12.0/json-stringify/json-stringify-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/datatable-column-widths/datatable-column-widths-min.js&yui.3.12.0/datatable-message/lang/datatable-message.js&yui.3.12.0/datatable-message/datatable-message-min.js&yui.3.12.0/datatable-mutable/datatable-mutable-min.js&yui.3.12.0/datatable-sort/lang/datatable-sort.js&yui.3.12.0/datatable-sort/datatable-sort-min.js&yui.3.12.0/datasource-local/datasource-local-min.js&yui.3.12.0/datatable-datasource/datatable-datasource-min.js&yui.3.12.0/datasource-get/datasource-get-min.js&yui.3.12.0/dataschema-base/dataschema-base-min.js&yui.3.12.0/dataschema-json/dataschema-json-min.js&yui.3.12.0/datasource-jsonschema/datasource-jsonschema-min.js&yui.3.12.0/datatype-number-parse/datatype-number-parse-min.js&yui.3.12.0/datatype-number-format/datatype-number-format-min.js&yui.3.12.0/datatype-xml-parse/datatype-xml-parse-min.js&yui.3.12.0/datatype-xml-format/datatype-xml-format-min.js&gallery-2013.09.18-18-49/build/gallery-datatable-paginator/gallery-datatable-paginator-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/anim-base/anim-base-min.js&yui.3.12.0/anim-color/anim-color-min.js&yui.3.12.0/anim-xy/anim-xy-min.js&yui.3.12.0/anim-curve/anim-curve-min.js&yui.3.12.0/anim-easing/anim-easing-min.js&yui.3.12.0/anim-node-plugin/anim-node-plugin-min.js&yui.3.12.0/anim-scroll/anim-scroll-min.js&yui.3.12.0/querystring-stringify/querystring-stringify-min.js&yui.3.12.0/datasource-io/datasource-io-min.js&yui.3.12.0/model-sync-rest/model-sync-rest-min.js&yui.3.12.0/tabview-base/tabview-base-min.js&yui.3.12.0/event-simulate/event-simulate-min.js&yui.3.12.0/async-queue/async-queue-min.js&yui.3.12.0/gesture-simulate/gesture-simulate-min.js&yui.3.12.0/node-event-simulate/node-event-simulate-min.js&yui.3.12.0/node-focusmanager/node-focusmanager-min.js&yui.3.12.0/tabview/tabview-min.js&yui.3.12.0/widget-autohide/widget-autohide-min.js&yui.3.12.0/button-core/button-core-min.js&yui.3.12.0/button-plugin/button-plugin-min.js&yui.3.12.0/widget-buttons/widget-buttons-min.js&yui.3.12.0/widget-modality/widget-modality-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?yui.3.12.0/panel/panel-min.js&yui.3.12.0/yui-throttle/yui-throttle-min.js&yui.3.12.0/dd-ddm-base/dd-ddm-base-min.js&yui.3.12.0/dd-drag/dd-drag-min.js&yui.3.12.0/dd-plugin/dd-plugin-min.js&gallery-2013.09.18-18-49/build/gallery-paginator-view/gallery-paginator-view-min.js&gallery-2013.09.18-18-49/build/gallery-layout/gallery-layout-min.js&gallery-2013.09.18-18-49/build/gallery-quickedit/gallery-quickedit-min.js&gallery-2013.09.18-18-49/build/gallery-paginator/gallery-paginator-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?gallery-2013.09.18-18-49/build/gallery-funcprog/gallery-funcprog-min.js&gallery-2013.09.18-18-49/build/gallery-node-optimizations/gallery-node-optimizations-min.js&gallery-2013.09.18-18-49/build/gallery-dimensions/gallery-dimensions-min.js&gallery-2013.09.18-18-49/build/gallery-nodelist-extras2/gallery-nodelist-extras2-min.js&gallery-2013.09.18-18-49/build/gallery-formmgr-css-validation/gallery-formmgr-css-validation-min.js&{{.flash.dateFlag}}"></script>
<script type="text/javascript" src="/app/combo?gallery-2013.09.18-18-49/build/gallery-object-extras/gallery-object-extras-min.js&gallery-2013.09.18-18-49/build/gallery-nodelist-extras/gallery-nodelist-extras-min.js&{{.flash.dateFlag}}"></script>

<script type="text/javascript">
	var g_dataBo = {{.result.dataBoJson}};
	var g_formTemplateJsonData = {{.result.formTemplateJsonData}};
	{{if .result.dataSourceJson}}
	var g_dataSourceJson = {{.result.dataSourceJson}};
	{{else}}
	var g_dataSourceJson = null;
	{{end}}
	if (g_dataSourceJson) {
		var modelTemplateFactory = new ModelTemplateFactory();
		modelTemplateFactory.enhanceDataSource(g_dataSourceJson);
		if (typeof(modelExtraInfo) != "undefined") {
			modelTemplateFactory.extendDataSource(g_dataSourceJson, modelExtraInfo);
		}
	}
	if (g_formTemplateJsonData) {
		var formTemplateFactory = new FormTemplateFactory();
		if (typeof(modelExtraInfo) != "undefined") {
			formTemplateFactory.extendFormTemplate(modelExtraInfo);
		}
	}
	{{if .result.layerBoJson}}
	var g_layerBo = {{.result.layerBoJson}};
	{{else}}
	var g_layerBo = null;
	{{end}}
	{{if .result.layerBoLiJson}}
	var g_layerBoLi = {{.result.layerBoLiJson}};
	{{else}}
	var g_layerBoLi = null;
	{{end}}
	
	{{if .result.usedCheckJson}}
	var g_usedCheck = {{.result.usedCheckJson}};
	{{else}}
	var g_usedCheck = {};
	{{end}}
	
	{{if .result.relationBoJson}}
	var g_relationBo = {{.result.relationBoJson}};
	{{else}}
	var g_relationBo = null;
	{{end}}
	var g_relationManager = new RelationManager();
	
	var g_masterFormFieldLi = [];
	var g_masterFormFieldDict = {};
	var g_gridPanelDict = {};
	var g_formStatus = "{{.result.formStatus}}";// 表单状态,view或""
	var g_copyFlag = "{{.result.copyFlag}}";// true|false,是否从列表页点击复制按钮进入
	var g_id = "{{.result.id}}";
	
	var g_yuiCommondLi = [];
	//var masterRenderLiJson = {{.result.masterRenderLiJson}};
	var g_Y = null;
</script>
</head>

<body class="yui3-skin-sam yui3-skin-finance">
	{{$tResult := .result}}
	{{range $index, $item := .result.formTemplate.FormElemLi}}
		{{if eq $item.XMLName.Local "html"}}
			{{$item.Html.Value}}
		{{end}}
		{{if eq $item.XMLName.Local "toolbar"}}
		<div class="formToolbar form-hd">
			{{range $toolbarBoKey, $toolbarBoValue := $tResult.toolbarBo}}
				{{if eq $toolbarBoKey $item.Toolbar.Name}}
					{{$toolbarBo := $toolbarBoValue}}
					{{range $btnIndex,$btnValue := $item.Toolbar.ButtonLi}}
						{{range $subIndex,$subValue := $toolbarBo}}
							{{if eq $btnIndex $subIndex}}
								{{if $subValue.isShow}}
									{{if eq $btnValue.Mode "fn"}}
										<input type="button" id="{{$btnValue.Name}}" value="{{$btnValue.Text}}" class="{{$btnValue.IconCls}}" onclick="{{$btnValue.Handler}}('{{$btnValue.Name}}')"/>
									{{end}}
									{{if eq $btnValue.Mode "url"}}
										<input type="button" id="{{$btnValue.Name}}" value="{{$btnValue.Text}}" class="{{$btnValue.IconCls}}" onclick="location.href='{{$btnValue.Handler}}'"/>
									{{end}}
									{{if eq $btnValue.Mode "url^"}}
										<input type="button" id="{{$btnValue.Name}}" value="{{$btnValue.Text}}" class="{{$btnValue.IconCls}}" onclick="alert('需要用弹出{{$btnValue.Handler}}')"/>
									{{end}}
								{{end}}
							{{end}}
						{{end}}
					{{end}}
				{{end}}
			{{end}}
		</div>
		{{end}}
		{{if eq $item.XMLName.Local "column-model"}}
			{{if eq $item.DataSetId "A"}}
			<div id="{{$item.DataSetId}}_{{$index}}" style="visibility: hidden;" class="form-main">
				{{if eq $item.ColumnModel.IdColumn.Hideable "true"}}
				<!-- 
				<input type="hidden" name="{{$item.ColumnModel.IdColumn.Name}}" value="" />
				 -->
				<div id="{{$item.ColumnModel.DataSetId}}_{{$item.ColumnModel.IdColumn.Name}}_render" style="display: none"></div>
				<script type="text/javascript">
				g_yuiCommondLi.push(function(Y) {
					var formFieldFactory = new FormFieldFactory();
					var field = formFieldFactory.getFormField(Y, '{{$item.ColumnModel.IdColumn.Name}}', '{{$item.ColumnModel.DataSetId}}');
					field.render("#{{$item.ColumnModel.DataSetId}}_{{$item.ColumnModel.IdColumn.Name}}_render");
					g_masterFormFieldLi.push(field);
					g_masterFormFieldDict['{{$item.ColumnModel.IdColumn.Name}}'] = field;
				});
				</script>
				{{end}}
				{{range $hiddenIndex, $hiddenItem := $item.ColumnModel.ColumnLi}}
					{{if eq $hiddenItem.Hideable "true"}}
						<!-- 
						<input type="hidden" name="{{$hiddenItem.Name}}" value="" />
						 -->
						<div id="{{$item.ColumnModel.DataSetId}}_{{$hiddenItem.Name}}_render" style="display: none"></div>
						<script type="text/javascript">
						g_yuiCommondLi.push(function(Y) {
							var formFieldFactory = new FormFieldFactory();
							var field = formFieldFactory.getFormField(Y, '{{$hiddenItem.Name}}', '{{$item.ColumnModel.DataSetId}}');
							field.render("#{{$item.ColumnModel.DataSetId}}_{{$hiddenItem.Name}}_render");
							g_masterFormFieldLi.push(field);
							g_masterFormFieldDict['{{$hiddenItem.Name}}'] = field;
						});
						</script>
					{{end}}
				{{end}}
				{{range $masterRenderKey, $masterRenderValue := $tResult.masterRenderLi}}
					{{if eq $masterRenderKey $item.RenderTag}}
						<table border="0" width="100%" class="form-main-table">
							{{range $lineIndex, $lineItem := $masterRenderValue}}
								<tr>
									{{range $tdIndex, $tdItem := $lineItem}}
									{{if eq $tdItem.isHtml "true"}}
										{{$tdItem.html}}
									{{else}}
										<td width="{{$tdItem.labelWidth}}" class="searchTitle">
											{{if eq $tdItem.required "true"}}<font style="color: red">*</font>{{end}}
											{{$tdItem.label}}：
										</td>
										<td width="{{$tdItem.columnWidth}}" colspan="{{$tdItem.columnSpan}}">
											<div id="{{$item.DataSetId}}_{{$tdItem.name}}_render"></div>
											<script type="text/javascript">
											g_yuiCommondLi.push(function(Y) {
												var formFieldFactory = new FormFieldFactory();
												var field = formFieldFactory.getFormField(Y, '{{$tdItem.name}}', '{{$item.DataSetId}}');
												field.render("#{{$item.DataSetId}}_{{$tdItem.name}}_render");
												g_masterFormFieldLi.push(field);
												g_masterFormFieldDict['{{$tdItem.name}}'] = field;
											});
											</script>
										</td>
									{{end}}
									{{end}}
								</tr>
							{{end}}
						</table>
					{{end}}
				{{end}}
			</div>
			<script type="text/javascript">
			g_yuiCommondLi.push(function(Y) {
				Y.one("#{{$item.DataSetId}}_{{$index}}").setStyle("visibility", "visible");
			});
			</script>
			{{else}}
				{{if $item.Text}}
					<div id="{{$item.DataSetId}}_{{$index}}_title" style="visibility: hidden;" class="panel-header">
						<div class="panel-title">{{$item.Text}}</div>
					</div>
					<script type="text/javascript">
					g_yuiCommondLi.push(function(Y) {
						Y.one("#{{$item.DataSetId}}_{{$index}}_title").setStyle("visibility", "visible");
					});
					</script>
				{{end}}
				{{if $item.ColumnModel.Toolbar.ButtonLi}}
					{{if eq $tResult.formTemplate.DataSourceModelId ""}}
						{{if eq $item.Name ""}}
							<div id="columnModel_{{$index}}_tbar" style="visibility: hidden;" class="formToolbar">
						{{else}}
							<div id="{{$item.Name}}_tbar" style="visibility: hidden;" class="formToolbar">
						{{end}}
					{{else}}
						<div id="{{$item.DataSetId}}_tbar" style="visibility: hidden;" class="formToolbar">
					{{end}}
					{{range $tbarIndex, $tbarItem := $item.ColumnModel.Toolbar.ButtonLi}}
						{{if eq $tbarItem.Mode "fn"}}
							<input type="button" value="{{$tbarItem.Text}}" class="{{$tbarItem.IconCls}}" onclick="{{$tbarItem.Handler}}('{{$item.DataSetId}}', '{{$tbarItem.Name}}')"/>
						{{end}}
						{{if eq $tbarItem.Mode "url"}}
							<input type="button" value="{{$tbarItem.Text}}" class="{{$tbarItem.IconCls}}" onclick="location.href='{{$tbarItem.Handler}}'"/>
						{{end}}
						{{if eq $tbarItem.Mode "url^"}}
							<input type="button" value="{{$tbarItem.Text}}" class="{{$tbarItem.IconCls}}" onclick="alert('需要用弹出{{$tbarItem.Handler}}')"/>
						{{end}}
					{{end}}
					</div>
					
					{{if eq $tResult.formTemplate.DataSourceModelId ""}}
						{{if eq $item.Name ""}}
							<script type="text/javascript">
							g_yuiCommondLi.push(function(Y) {
								Y.one("#columnModel_{{$index}}_tbar").setStyle("visibility", "visible");
							});
							</script>
						{{else}}
							<script type="text/javascript">
							g_yuiCommondLi.push(function(Y) {
								Y.one("#{{$item.Name}}_tbar").setStyle("visibility", "visible");
							});
							</script>
						{{end}}
					{{else}}
						<script type="text/javascript">
						g_yuiCommondLi.push(function(Y) {
							Y.one("#{{$item.DataSetId}}_tbar").setStyle("visibility", "visible");
						});
						</script>
					{{end}}
				{{end}}
				{{if eq $tResult.formTemplate.DataSourceModelId ""}}
					{{if eq $item.Name ""}}
						<div id="columnModel_{{$index}}"></div>
					{{else}}
						<div id="{{$item.Name}}_{{$index}}"></div>
					{{end}}
				{{else}}
					<div id="{{$item.DataSetId}}_{{$index}}"></div>
				{{end}}
			<script type="text/javascript">
				g_yuiCommondLi.push(function(Y) {
					//,"gallery-aui-calendar-datepicker-select"
					var columnModel = null;
					for (var i = 0; i < g_formTemplateJsonData.FormElemLi.length; i++) {
						if ((i + "") == "{{$index}}") {
							columnModel = g_formTemplateJsonData.FormElemLi[i].ColumnModel;
							break;
						}
					}
					if (columnModel) {
						var dataTableManager = new DataTableManager();
						var dataSourceModelId = g_formTemplateJsonData.DataSourceModelId;
						var columnModelName = "";
						if (!dataSourceModelId) {
							if (!columnModel.Name) {
								columnModelName = "columnModel_{{$index}}";
							} else {
								columnModelName = columnModel.Name;
							}
						} else {
							columnModelName = columnModel.DataSetId;
							if (!columnModel.DataSetId) {
								console.log("dataSourceModelId:" + dataSourceModelId + ", exist columnModel which dataSetId is empty");
							}
						}
						var isRender = true;
						var isRenderList = false;
						var items = g_dataBo[columnModelName] || [];
						if (!dataSourceModelId) {
							isRenderList = !columnModel.DisplayMode || columnModel.DisplayMode == "list";
							isRender = isRenderList;
						} else {
							if (columnModel.DataSetId == "A") {
								isRenderList = false;
								items = g_dataBo[columnModelName] || {};
							} else {
								isRenderList = !columnModel.DisplayMode || columnModel.DisplayMode == "list";
							}
						}
						if (isRender) {
							if (isRenderList) {
								var param = {
									data:items,
									columnModel:columnModel,
									columnModelName:columnModelName,
									render:"#" + columnModelName + "_{{$index}}",
									url:"",
									totalResults: g_dataBo.totalResults || 50,
									pageSize: 10000,
									paginatorContainer : null,
									paginatorTemplate : null,
									columnManager: new ColumnDataSourceManager()
								};
								// 表格的编辑控件,需要dataSource,
								if (g_dataSourceJson) {
									param["dataSourceJson"] = g_dataSourceJson;
								}
								dataTableManager.createDataGrid(Y, param);
								g_gridPanelDict[columnModelName] = dataTableManager;
							} else {
								// renderForm,不实现,放到主数据集中处理
								console.log("detailDataSet which dataSetId is:" + columnModelName + " can't render to form,");
							}
						}
					}
				});
				</script>
			{{end}}
		{{end}}
	{{end}}
	<div style="display: none">
		<img src="/public/galleryimages/loading_indicator.gif?{{.DATE_FLAG}}" title="加载中..." border="0" width="16" height="16"/>
	</div>
	<script type="text/javascript">
		YUI(g_financeModule).use("finance-module", function(Y) {
			g_Y = Y;
			for (var i = 0; i < g_yuiCommondLi.length; i++) {
				g_yuiCommondLi[i](Y);
			}
			if (typeof(main) !== "undefined") {
				main(Y);
			}
		});
	</script>
</body>
</html>
